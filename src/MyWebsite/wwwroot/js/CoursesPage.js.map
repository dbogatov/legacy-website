{"version":3,"sources":["CoursesPage.ts"],"names":[],"mappings":"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","file":"CoursesPage.js","sourcesContent":["import util = require('Utility');\n\nclass CoursesPage {\n\tprivate courses: Course[];\n\n\tprivate static letterToNumber = {\n\t\tA: 4,\n\t\tB: 3,\n\t\tC: 2,\n\t\tNR: 0\n\t};\n\n\tprivate static parentTemplate = _.template(`\n\t\t<h3 class=\"majorRequirement\"><%= title %> (GPA:  <%= gpa %>)</h3>\n\t\t<hr id=\"<%= htmlId %>\" />\n\t`);\n\n\tprivate static childTemplate = _.template(`\n\t\t<h4 class=\"text-center\"><%= reqText %> (GPA: <%= gpa %>)</h4>\n\t\t<table id=\"gradeTable_<%= reqId %>\" class=\"table table-striped table-bordered table-hover\">\n\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th>Term</th>\n\t\t\t\t\t<th>Year</th>\n\t\t\t\t\t<th>Title</th>\n\t\t\t\t\t<th>Grade</th>\n\t\t\t\t\t<th>Status</th>\n\t\t\t\t</tr>\n\t\t\t</thead>\n\t\t\t<tbody>\n\t\t\t\t<% _.each(courses,function(course){ %>\n\t\t\t\t\t<%= course %>\n\t\t\t\t<% }); %>\n\t\t\t</tbody>\n\t\t</table>\n\t`);\n\n\tprivate sortGrades(): void {\n\n\t\t// little hack\t\t\n\t\t(<any>$(\".table\")).tablesorter({\n\n\t\t\tsortList: [[1, 1], [0, 1]],\n\n\t\t\ttextExtraction: function(node) {\n\t\t\t\tswitch ($(node).text()) {\n\t\t\t\t\tcase \"A\":\n\t\t\t\t\t\treturn \"C\";\n\t\t\t\t\tcase \"B\":\n\t\t\t\t\t\treturn \"D\";\n\t\t\t\t\tcase \"C\":\n\t\t\t\t\t\treturn \"A\";\n\t\t\t\t\tcase \"D\":\n\t\t\t\t\t\treturn \"B\";\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn $(node).text();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate computeGPA(courses: Array<Course>): string {\n\t\tvar completed = courses.filter((course) => course.status === \"Completed\");\n\n\t\treturn (completed\n\t\t\t.map((course) => CoursesPage.letterToNumber[course.gradeLetter])\n\t\t\t.reduce((accumulator, element) => accumulator + element, 0) /\n\t\t\t(completed.length > 0 ? completed.length : 1))\n\t\t\t.toPrecision(3);\n\t}\n\n\tprivate groupParentRequirements() {\n\t\tvar dictionary = {};\n\n\t\tthis.courses.forEach((course) => {\n\t\t\tif (dictionary[course.parentRequirement.title] === undefined) {\n\t\t\t\tdictionary[course.parentRequirement.title] = new Array<Course>(course);\n\t\t\t} else {\n\t\t\t\tdictionary[course.parentRequirement.title].push(course);\n\t\t\t}\n\t\t});\n\n\t\treturn dictionary;\n\t}\n\n\tprivate groupCourses() {\n\t\tvar dictionary = {};\n\n\t\tthis.courses.forEach((course) => {\n\t\t\tif (dictionary[course.requirement] === undefined) {\n\t\t\t\tdictionary[course.requirement] = new Array<Course>(course);\n\t\t\t} else {\n\t\t\t\tdictionary[course.requirement].push(course);\n\t\t\t}\n\t\t});\n\n\t\treturn dictionary;\n\t}\n\n\tprivate drawParentRequirements() {\n\t\tvar dictionary = this.groupParentRequirements();\n\n\t\tfor (var requirement in dictionary) {\n\t\t\tvar courses = <Array<Course>>dictionary[requirement];\n\t\t\tvar column = courses[0].parentRequirement.column === 1 ? \"leftBlock\" : \"rightBlock\";\n\n\t\t\t$(`#${column}`).append(CoursesPage.parentTemplate({\n\t\t\t\tgpa: this.computeGPA(courses),\n\t\t\t\ttitle: requirement,\n\t\t\t\thtmlId: requirement.replace(/\\W/g, '')\n\t\t\t}));\n\t\t}\n\t}\n\n\tprivate displayCourses(): void {\n\t\tthis.drawParentRequirements();\n\n\t\tvar dictionary = this.groupCourses();\n\n\t\tfor (var requirement in dictionary) {\n\t\t\tvar courses = <Array<Course>>dictionary[requirement];\n\t\t\tvar htmlId = courses[0].parentRequirement.title.replace(/\\W/g, '');\n\n\t\t\tvar html = CoursesPage.childTemplate({\n\t\t\t\tgpa: this.computeGPA(courses),\n\t\t\t\treqId: courses[0].requirement.replace(/\\W/g, ''),\n\t\t\t\treqText: courses[0].requirement,\n\t\t\t\tcourses: courses.map((course) => course.getHtmlView())\n\t\t\t});\n\n\t\t\t$(`#${htmlId}`).after(html);\n\t\t}\n\n\t\tthis.sortGrades();\n\t}\n\n\tprivate displayTotalGPA(): void {\n\t\t$(\"#totalGPA\").html(this.computeGPA(this.courses));\n\t}\n\n\tprivate loadCourses(): void {\n\t\t$.get(\"/api/Courses\", {}, courses => {\n\t\t\tthis.courses = courses.map(course =>\n\t\t\t\tnew Course().deserialize(course)\n\t\t\t);\n\n\t\t\tthis.displayCourses();\n\t\t\tthis.displayTotalGPA();\n\t\t});\n\t}\n\n\trun() {\n\t\tutil.Utility.Utility.enableAJAXLoadBar();\n\t\tthis.loadCourses();\n\t}\n}\n\nclass Course implements util.Utility.ISerializable<Course>, util.Utility.ITemplatable {\n\tprivate static template = _.template(`\n\t\t<tr class=\"<%- color %>\">\n\t\t\t<td><%- term %>\n\t\t\t<td><%- year %>\n\t\t\t<td><%- title %>\n\t\t\t<td><%- grade %>\n\t\t\t<td><%- status %>\n\t\t</tr>\n\t`);\n\n\ttitle: string;\n\tterm: string;\n\tyear: number;\n\tcourseId: string;\n\tgradePercent: string;\n\tgradeLetter: string;\n\tstatus: string;\n\trequirement: string;\n\tparentRequirement: {\n\t\ttitle: string,\n\t\tcolumn: number;\n\t}\n\n\n\tdeserialize(input): Course {\n\t\tthis.title = input.Title;\n\t\tthis.term = input.Term;\n\t\tthis.year = input.Year;\n\t\tthis.courseId = input.CourseId;\n\t\tthis.gradePercent = input.GradePercent;\n\t\tthis.gradeLetter = input.GradeLetter;\n\t\tthis.status = input.Status;\n\t\tthis.requirement = input.Requirement.ReqName;\n\t\tthis.parentRequirement = {\n\t\t\ttitle: input.Requirement.ParentRequirement.Title,\n\t\t\tcolumn: input.Requirement.ParentRequirement.DisplayColumn\n\t\t};\n\n\t\treturn this;\n\t}\n\n\tgetHtmlView(): string {\n\t\tvar color: string;\n\n\t\tswitch (this.status) {\n\t\t\tcase \"Completed\":\n\t\t\t\tcolor = \"success\";\n\t\t\t\tbreak;\n\t\t\tcase \"in progress...\":\n\t\t\t\tcolor = \"active\";\n\t\t\t\tbreak;\n\t\t\tcase \"Registered\":\n\t\t\t\tcolor = \"warning\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tcolor = \"danger\";\n\t\t}\n\n\t\treturn Course.template({\n\t\t\tterm: this.term.toUpperCase(),\n\t\t\tyear: this.year,\n\t\t\ttitle: this.title,\n\t\t\tgrade: this.gradeLetter,\n\t\t\tstatus: this.status,\n\t\t\tcolor: color\n\t\t});\n\t}\n}\n\nexport = CoursesPage;"],"sourceRoot":"/source/"}